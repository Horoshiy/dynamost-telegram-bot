# –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ (v3) ‚Äî Telegram-–±–æ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ—É—Ç–±–æ–ª—å–Ω—ã–º –∫–ª—É–±–æ–º

**–î–∞—Ç–∞:** 2025-10-26  
**–Ø–∑—ã–∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** Go ‚â• 1.22  
**–ë–î:** PostgreSQL  
**–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å:** Telegram Bot API —Å inline-–∫–Ω–æ–ø–∫–∞–º–∏ (–±–µ–∑ –¥–ª–∏–Ω–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏)  

---

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

1. [–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞](#—Ü–µ–ª—å-–ø—Ä–æ–µ–∫—Ç–∞)  
2. [–†–æ–ª–∏ –¥–æ—Å—Ç—É–ø–∞](#—Ä–æ–ª–∏-–¥–æ—Å—Ç—É–ø–∞)  
3. [–°—É—â–Ω–æ—Å—Ç–∏ –¥–æ–º–µ–Ω–∞](#—Å—É—â–Ω–æ—Å—Ç–∏-–¥–æ–º–µ–Ω–∞)  
   - [Team (–ö–æ–º–∞–Ω–¥–∞)](#team-–∫–æ–º–∞–Ω–¥–∞)  
   - [Player (–ò–≥—Ä–æ–∫)](#player-–∏–≥—Ä–æ–∫)  
   - [Tournament (–¢—É—Ä–Ω–∏—Ä)](#tournament-—Ç—É—Ä–Ω–∏—Ä)  
   - [TournamentRoster (–ó–∞—è–≤–∫–∞ –Ω–∞ —Ç—É—Ä–Ω–∏—Ä)](#tournamentroster-–∑–∞—è–≤–∫–∞-–Ω–∞-—Ç—É—Ä–Ω–∏—Ä)  
   - [Match (–ú–∞—Ç—á)](#match-–º–∞—Ç—á)  
   - [MatchLineupItem (–°–æ—Å—Ç–∞–≤ –Ω–∞ –º–∞—Ç—á)](#matchlineupitem-—Å–æ—Å—Ç–∞–≤-–Ω–∞-–º–∞—Ç—á)  
   - [MatchEvent (–°–æ–±—ã—Ç–∏–µ –º–∞—Ç—á–∞)](#matchevent-—Å–æ–±—ã—Ç–∏–µ-–º–∞—Ç—á–∞)  
4. [–ù–∞–≤–∏–≥–∞—Ü–∏—è –≤ –±–æ—Ç–µ (UX)](#–Ω–∞–≤–∏–≥–∞—Ü–∏—è-–≤-–±–æ—Ç–µ-ux)  
   - [/tournaments](#/tournaments)  
   - [/teams](#/teams)  
   - [/players](#/players)  
   - [/tournament_rosters](#/tournament_rosters)  
   - [/games](#/games)  
5. [–°—Ö–µ–º–∞ –ë–î (PostgreSQL)](#—Å—Ö–µ–º–∞-–±–¥-postgresql)  
6. [–í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞](#–≤–∞–ª–∏–¥–∞—Ü–∏—è-–∏-–±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞)  
7. [–ù–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è](#–Ω–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)  
8. [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –æ–∫—Ä—É–∂–µ–Ω–∏–µ](#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è-–∏-–æ–∫—Ä—É–∂–µ–Ω–∏–µ)  
9. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è)  
10. [–ú–∏–≥—Ä–∞—Ü–∏–∏](#–º–∏–≥—Ä–∞—Ü–∏–∏)  
11. [Definition of Done](#definition-of-done)  
12. [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è Codex](#–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è-–¥–ª—è-codex)  
    - [Callback-–ø–∞—Ç—Ç–µ—Ä–Ω—ã](#callback-–ø–∞—Ç—Ç–µ—Ä–Ω—ã)  
    - [State machine / wizard](#state-machine--wizard)  
    - [–°–µ—Ä–≤–∏—Å—ã (–∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã)](#—Å–µ—Ä–≤–∏—Å—ã-–∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã)  
    - [–ó–∞–¥–∞—á–∏ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ Codex](#–∑–∞–¥–∞—á–∏-–¥–ª—è-–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏-codex)  
13. [–î–∞–ª—å–Ω–µ–π—à–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (–Ω–µ –≤ —ç—Ç–æ–º —ç—Ç–∞–ø–µ)](#–¥–∞–ª—å–Ω–µ–π—à–∏–µ-—Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è-–Ω–µ-–≤-—ç—Ç–æ–º-—ç—Ç–∞–ø–µ)

---

## –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞

–°–æ–∑–¥–∞—Ç—å Telegram-–±–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º –∫–ª—É–±–∞ —É–ø—Ä–∞–≤–ª—è—Ç—å –∫–æ–º–∞–Ω–¥–∞–º–∏, –∏–≥—Ä–æ–∫–∞–º–∏, —Ç—É—Ä–Ω–∏—Ä–∞–º–∏, –∑–∞—è–≤–∫–∞–º–∏ –∏–≥—Ä–æ–∫–æ–≤ –Ω–∞ —Ç—É—Ä–Ω–∏—Ä, –º–∞—Ç—á–∞–º–∏, —Å–æ—Å—Ç–∞–≤–∞–º–∏ –∏ —Å–æ–±—ã—Ç–∏—è–º–∏ –º–∞—Ç—á–∞ —á–µ—Ä–µ–∑ —É–¥–æ–±–Ω—ã–µ **inline-–∫–Ω–æ–ø–∫–∏**.  
–¢–µ–∫—Å—Ç–æ–≤—ã–µ slash-–∫–æ–º–∞–Ω–¥—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è **—Ç–æ–ª—å–∫–æ** –∫–∞–∫ –≤—Ö–æ–¥ –≤ —Ä–∞–∑–¥–µ–ª—ã:

- `/tournaments`
- `/teams`
- `/players`
- `/tournament_rosters`
- `/games`

–î–∞–ª–µ–µ –≤—Å—è —Ä–∞–±–æ—Ç–∞ ‚Äî –∫–Ω–æ–ø–∫–∞–º–∏ –∏ –ø–æ—à–∞–≥–æ–≤—ã–º–∏ –¥–∏–∞–ª–æ–≥–∞–º–∏.

---

## –†–æ–ª–∏ –¥–æ—Å—Ç—É–ø–∞

### –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
- Telegram `user_id` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Å–ø–∏—Å–∫–µ `ADMIN_TELEGRAM_IDS` (–∫–æ–Ω—Ñ–∏–≥/–ë–î).
- –ò–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º CRUD-–æ–ø–µ—Ä–∞—Ü–∏—è–º –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏.

### –ù–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
- –ü–æ–ª—É—á–∞–µ—Ç –æ—Ç–≤–µ—Ç: `–£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä—É –∫–ª—É–±–∞.`
- –ê–¥–º–∏–Ω—Å–∫–∏–µ –∫–Ω–æ–ø–∫–∏ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è.

---

## –°—É—â–Ω–æ—Å—Ç–∏ –¥–æ–º–µ–Ω–∞

### Team (–ö–æ–º–∞–Ω–¥–∞)

–ê–¥–º. –µ–¥–∏–Ω–∏—Ü–∞: ¬´–î–∏–Ω–∞–º—á–∏–∫–∏ –Æ–≥¬ª, ¬´–¶–µ–Ω—Ç—Ä¬ª, ¬´204-–π –∫–≤–∞—Ä—Ç–∞–ª¬ª.  
**–ù–µ** —Ö—Ä–∞–Ω–∏–º —Ç—Ä–µ–Ω–µ—Ä–∞, –≥–æ–¥ —Ä–æ–∂–¥–µ–Ω–∏—è, –≤–æ–∑—Ä–∞—Å—Ç.

**–ü–æ–ª—è:**
- `id`
- `name` ‚Äî –ø–æ–ª–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
- `short_code` ‚Äî –∫–æ—Ä–æ—Ç–∫–∏–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–æ–¥
- `active` ‚Äî —Ñ–ª–∞–≥ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- `note` ‚Äî –ø—Ä–∏–º–µ—á–∞–Ω–∏–µ
- `created_at`, `updated_at`

---

### Player (–ò–≥—Ä–æ–∫)

–§—É—Ç–±–æ–ª–∏—Å—Ç –∫–ª—É–±–∞. **–ù–æ–º–µ—Ä –Ω–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ Player.**

**–ü–æ–ª—è:**
- `id`
- `full_name`
- `birth_date` (NULLable)
- `position` (NULLable, —Ç–µ–∫—Å—Ç)
- `active` (bool)
- `note` (NULLable)
- `created_at`, `updated_at`

---

### Tournament (–¢—É—Ä–Ω–∏—Ä)

**–ü–æ–ª—è:**
- `id`
- `name`
- `type` (—Å—Ç—Ä–æ–∫–∞ ‚Äî ¬´–ª–∏–≥–∞¬ª, ¬´–∫—É–±–æ–∫¬ª, ¬´—Ç–æ–≤–∞—Ä–∏—â–µ—Å–∫–∏–π¬ª, ‚Ä¶)
- `status` ‚Äî `planned` / `active` / `finished`
- `start_date`, `end_date` (NULLable)
- `note` (NULLable)
- `created_at`, `updated_at`

---

### TournamentRoster (–ó–∞—è–≤–∫–∞ –Ω–∞ —Ç—É—Ä–Ω–∏—Ä)

–ö–ª—é—á–µ–≤–∞—è —Å—É—â–Ω–æ—Å—Ç—å: —Å–≤—è–∑—å ¬´–ò–≥—Ä–æ–∫ ‚Äî –ö–æ–º–∞–Ω–¥–∞ ‚Äî –¢—É—Ä–Ω–∏—Ä¬ª, –≥–¥–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è **–Ω–æ–º–µ—Ä –∏–≥—Ä–æ–∫–∞ –Ω–∞ —Ç—É—Ä–Ω–∏—Ä**.

**–ü–æ–ª—è:**
- `id`
- `tournament_id` ‚Üí `tournaments.id`
- `team_id` ‚Üí `teams.id`
- `player_id` ‚Üí `players.id`
- `tournament_number` (INT, NULLable) ‚Äî –Ω–æ–º–µ—Ä –∏–≥—Ä–æ–∫–∞ –≤ **—ç—Ç–æ–º** —Ç—É—Ä–Ω–∏—Ä–µ
- `created_at`, `updated_at`

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ:**
- `UNIQUE (tournament_id, team_id, player_id)` ‚Äî –Ω–µ–ª—å–∑—è –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å –∏–≥—Ä–æ–∫–∞ –≤ –∑–∞—è–≤–∫–µ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã –Ω–∞ –æ–¥–∏–Ω —Ç—É—Ä–Ω–∏—Ä.

---

### Match (–ú–∞—Ç—á)

–ú–∞—Ç—á –≤—Å–µ–≥–¥–∞ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ `(tournament_id, team_id)`. –°–æ–∑–¥–∞–≤–∞—Ç—å –º–∞—Ç—á –º–æ–∂–Ω–æ **—Ç–æ–ª—å–∫–æ**, –µ—Å–ª–∏ –¥–ª—è —ç—Ç–æ–π –ø–∞—Ä—ã –µ—Å—Ç—å –∏–≥—Ä–æ–∫–∏ –≤ `tournament_roster`.

**–ü–æ–ª—è:**
- `id`
- `tournament_id` (–æ–±—è–∑–∞—Ç–µ–ª–µ–Ω)
- `team_id` (–æ–±—è–∑–∞—Ç–µ–ª–µ–Ω)
- `opponent_name` (—Å—Ç—Ä–æ–∫–∞)
- `start_time` (TIMESTAMPTZ)
- `location` (NULLable)
- `status` ‚Äî `scheduled` / `played` / `canceled`

**–°—á—ë—Ç—ã:**
- `score_ht`  ‚Äî —Å—Ç—Ä–æ–∫–∞ ¬´X:Y¬ª (1-–π —Ç–∞–π–º)
- `score_ft`  ‚Äî —Å—Ç—Ä–æ–∫–∞ ¬´X:Y¬ª (–ø–æ—Å–ª–µ 2-–≥–æ —Ç–∞–π–º–∞, –∏—Ç–æ–≥ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏)
- `score_et`  ‚Äî —Å—Ç—Ä–æ–∫–∞ ¬´X:Y¬ª (–ø–æ—Å–ª–µ –¥–æ–ø. –≤—Ä–µ–º–µ–Ω–∏, –µ—Å–ª–∏ –±—ã–ª–æ)
- `score_pen` ‚Äî —Å—Ç—Ä–æ–∫–∞ ¬´X:Y¬ª (—Å–µ—Ä–∏—è –ø–µ–Ω–∞–ª—å—Ç–∏, –µ—Å–ª–∏ –±—ã–ª–∞)
- `score_final_us`   ‚Äî –∏—Ç–æ–≥–æ–≤—ã–µ –≥–æ–ª—ã –Ω–∞—à–µ–π –∫–æ–º–∞–Ω–¥—ã (INT)
- `score_final_them` ‚Äî –∏—Ç–æ–≥–æ–≤—ã–µ –≥–æ–ª—ã —Å–æ–ø–µ—Ä–Ω–∏–∫–∞ (INT)

**–ü—Ä–∞–≤–∏–ª–æ:**
- –ü—Ä–∏ `status = canceled` –≤—Å–µ –ø–æ–ª—è —Å—á—ë—Ç–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å `NULL`.

---

### MatchLineupItem (–°–æ—Å—Ç–∞–≤ –Ω–∞ –º–∞—Ç—á)

–°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤, –∑–∞—è–≤–ª–µ–Ω–Ω—ã—Ö –Ω–∞ **–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –º–∞—Ç—á**, –∏ –∏—Ö —Ä–æ–ª–∏.  
–ò–≥—Ä–æ–∫ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ `tournament_roster` –¥–ª—è –ø–∞—Ä—ã `(match.tournament_id, match.team_id)`.

**–ü–æ–ª—è:**
- `id`
- `match_id`
- `player_id`
- `role` ‚Äî `"start"` | `"sub"`
- `number_override` (INT, NULLable) ‚Äî –Ω–æ–º–µ—Ä **–∏–º–µ–Ω–Ω–æ** –Ω–∞ —ç—Ç–æ—Ç –º–∞—Ç—á  
  (–µ—Å–ª–∏ –ø—É—Å—Ç–æ ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º `tournament_roster.tournament_number`)
- `note` (NULLable)
- `created_at`, `updated_at`

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ:**
- `UNIQUE (match_id, player_id)`

---

### MatchEvent (–°–æ–±—ã—Ç–∏–µ –º–∞—Ç—á–∞)

–î–æ–ø—É—Å—Ç–∏–º—ã–µ —Ç–∏–ø—ã: **`goal`**, **`card`**, **`sub`**.

**–ü–æ–ª—è:**
- `id`
- `match_id`
- `event_type` ‚Äî `"goal" | "card" | "sub"`
- `event_time` ‚Äî —Å—Ç—Ä–æ–∫–∞ (¬´5 –º–∏–Ω¬ª, ¬´45+2¬ª, ¬´1 —Ç–∞–π–º¬ª ‚Ä¶)
- `player_id_main`
- `player_id_alt` ‚Äî —Ç–æ–ª—å–∫–æ –¥–ª—è `sub`
- `card_type` ‚Äî —Ç–æ–ª—å–∫–æ –¥–ª—è `card`: `"yellow" | "red"`
- `created_at`

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**
- `goal` ‚Üí `player_id_main` –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω
- `card` ‚Üí `player_id_main` –∏ `card_type` –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã
- `sub` ‚Üí `player_id_main` –∏ `player_id_alt` –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã  
–í—Å–µ –∏–≥—Ä–æ–∫–∏ –¥–æ–ª–∂–Ω—ã –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –≤ `tournament_roster` –ø–∞—Ä—ã `(tournament_id, team_id)` –º–∞—Ç—á–∞.

---

## –ù–∞–≤–∏–≥–∞—Ü–∏—è –≤ –±–æ—Ç–µ (UX)

–ë–∞–∑–æ–≤—ã–µ –≤—Ö–æ–¥–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã ‚Üí —ç–∫—Ä–∞–Ω—ã —Å–æ —Å–ø–∏—Å–∫–∞–º–∏ –∏ –∫–Ω–æ–ø–∫–∞–º–∏. –î–∞–ª—å—à–µ ‚Äî –Ω–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ **inline-–∫–Ω–æ–ø–∫–∞–º**.  
–¢–µ–∫—Å—Ç –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è **—Ç–æ–ª—å–∫–æ** –∫–æ–≥–¥–∞ –±–æ—Ç –ø—Ä–æ—Å–∏—Ç –≤ —Ä–∞–º–∫–∞—Ö wizard.

### `/tournaments`

- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Ç—É—Ä–Ω–∏—Ä–æ–≤ (–æ–±—ã—á–Ω–æ `planned` + `active`) —Å –∫–Ω–æ–ø–∫–∞–º–∏:
  - ¬´–û—Ç–∫—Ä—ã—Ç—å —Ç—É—Ä–Ω–∏—Ä ‚Ä¶¬ª
  - ¬´‚ûï –°–æ–∑–¥–∞—Ç—å —Ç—É—Ä–Ω–∏—Ä¬ª
- –≠–∫—Ä–∞–Ω —Ç—É—Ä–Ω–∏—Ä–∞:
  - –¥–∞–Ω–Ω—ã–µ —Ç—É—Ä–Ω–∏—Ä–∞ (name/type/status/dates/note)
  - —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥, —É—á–∞—Å—Ç–≤—É—é—â–∏—Ö (–ø–æ `tournament_roster`)
  - –∫–Ω–æ–ø–∫–∏:
    - `‚úè –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å`
    - `üë• –ó–∞—è–≤–∫–∏ (—Å–æ—Å—Ç–∞–≤—ã –∫–æ–º–∞–Ω–¥)`
    - `üèü –ú–∞—Ç—á–∏`
    - `‚¨Ö –ù–∞–∑–∞–¥`

**Wizard ¬´–°–æ–∑–¥–∞—Ç—å —Ç—É—Ä–Ω–∏—Ä¬ª:**
1) –ù–∞–∑–≤–∞–Ω–∏–µ ‚Üí 2) –¢–∏–ø ‚Üí 3) –°—Ç–∞—Ç—É—Å ‚Üí 4) –î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ ‚Üí 5) –î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è ‚Üí 6) –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ ‚Üí –°–æ–∑–¥–∞—Ç—å.

---

### `/teams`

- –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ —Å –∫–Ω–æ–ø–∫–∞–º–∏:
  - ¬´–û—Ç–∫—Ä—ã—Ç—å ‚Ä¶¬ª
  - ¬´‚ûï –°–æ–∑–¥–∞—Ç—å –∫–æ–º–∞–Ω–¥—É¬ª
- –≠–∫—Ä–∞–Ω –∫–æ–º–∞–Ω–¥—ã:
  - `name / short_code / active / note`
  - `‚úè –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å` / `‚¨Ö –ù–∞–∑–∞–¥`

**Wizard ¬´–°–æ–∑–¥–∞—Ç—å –∫–æ–º–∞–Ω–¥—É¬ª:**
1) –ù–∞–∑–≤–∞–Ω–∏–µ ‚Üí 2) –ö–æ—Ä–æ—Ç–∫–∏–π –∫–æ–¥ ‚Üí 3) –ê–∫—Ç–∏–≤–Ω–∞? ‚Üí 4) –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ?

---

### `/players`

- –°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ (–ø–∞–≥–∏–Ω–∞—Ü–∏—è):
  - ¬´–û—Ç–∫—Ä—ã—Ç—å –∏–≥—Ä–æ–∫–∞ ‚Ä¶¬ª
  - ¬´‚û° –î–∞–ª–µ–µ¬ª
  - ¬´‚ûï –°–æ–∑–¥–∞—Ç—å –∏–≥—Ä–æ–∫–∞¬ª
- –≠–∫—Ä–∞–Ω –∏–≥—Ä–æ–∫–∞:
  - –§–ò–û, –¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è, –ø–æ–∑–∏—Ü–∏—è, –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, –ø—Ä–∏–º–µ—á–∞–Ω–∏–µ
  - –°–ø–∏—Å–æ–∫ —Ç–µ–∫—É—â–∏—Ö –∑–∞—è–≤–æ–∫: –¢—É—Ä–Ω–∏—Ä ‚Üí –ö–æ–º–∞–Ω–¥–∞ ‚Üí –ù–æ–º–µ—Ä (–∏–∑ `tournament_roster`)
  - `‚úè –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å` / `‚¨Ö –ù–∞–∑–∞–¥`

**Wizard ¬´–°–æ–∑–¥–∞—Ç—å –∏–≥—Ä–æ–∫–∞¬ª:**
1) –§–ò–û ‚Üí 2) –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è (–∏–ª–∏ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å) ‚Üí 3) –ü–æ–∑–∏—Ü–∏—è (–∏–ª–∏ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å) ‚Üí 4) –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ (–∏–ª–∏ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å).

---

### `/tournament_rosters`

–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∞–º–∏ –Ω–∞ —Ç—É—Ä–Ω–∏—Ä.

–ü–æ—Ç–æ–∫:
1) –í—ã–±–æ—Ä —Ç—É—Ä–Ω–∏—Ä–∞ ‚Üí 2) –í—ã–±–æ—Ä –∫–æ–º–∞–Ω–¥—ã –≤ —ç—Ç–æ–º —Ç—É—Ä–Ω–∏—Ä–µ ‚Üí 3) –≠–∫—Ä–∞–Ω –∑–∞—è–≤–∫–∏ (—Å–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ + –Ω–æ–º–µ—Ä–∞).

–ö–Ω–æ–ø–∫–∏:
- ¬´‚ûï –î–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä–æ–∫–∞¬ª
- ¬´‚úè –ò–∑–º–µ–Ω–∏—Ç—å –Ω–æ–º–µ—Ä –∏–≥—Ä–æ–∫–∞¬ª
- ¬´üóë –£–¥–∞–ª–∏—Ç—å –∏–≥—Ä–æ–∫–∞ –∏–∑ –∑–∞—è–≤–∫–∏¬ª
- ¬´‚¨Ö –ù–∞–∑–∞–¥¬ª

**–î–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä–æ–∫–∞:**
- –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤ (–ø–∞–≥–∏–Ω–∞—Ü–∏—è) ‚Üí –≤—ã–±—Ä–∞—Ç—å ‚Üí –∑–∞–ø—Ä–æ—Å–∏—Ç—å –Ω–æ–º–µ—Ä (–º–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å) ‚Üí —Å–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å `tournament_roster`.

**–ò–∑–º–µ–Ω–∏—Ç—å –Ω–æ–º–µ—Ä –∏–≥—Ä–æ–∫–∞:**
- –ü–æ–∫–∞–∑–∞—Ç—å –∏–≥—Ä–æ–∫–æ–≤ –∏–∑ –∑–∞—è–≤–∫–∏ ‚Üí –≤—ã–±—Ä–∞—Ç—å ‚Üí –∑–∞–ø—Ä–æ—Å–∏—Ç—å –Ω–æ–≤—ã–π –Ω–æ–º–µ—Ä ‚Üí UPDATE `tournament_number`.

**–£–¥–∞–ª–∏—Ç—å –∏–≥—Ä–æ–∫–∞ –∏–∑ –∑–∞—è–≤–∫–∏:**
- –ü–æ–∫–∞–∑–∞—Ç—å –∏–≥—Ä–æ–∫–æ–≤ –∏–∑ –∑–∞—è–≤–∫–∏ ‚Üí –≤—ã–±—Ä–∞—Ç—å ‚Üí –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ ‚Üí DELETE.

---

### `/games`

–†–∞–±–æ—Ç–∞ —Å –º–∞—Ç—á–∞–º–∏.

–ü–æ—Ç–æ–∫:
1) –í—ã–±–æ—Ä —Ç—É—Ä–Ω–∏—Ä–∞ ‚Üí 2) –í—ã–±–æ—Ä –∫–æ–º–∞–Ω–¥—ã (–∫–æ—Ç–æ—Ä–∞—è —É—á–∞—Å—Ç–≤—É–µ—Ç –≤ —Ç—É—Ä–Ω–∏—Ä–µ) ‚Üí 3) –°–ø–∏—Å–æ–∫ –º–∞—Ç—á–µ–π —ç—Ç–æ–π –∫–æ–º–∞–Ω–¥—ã.

–°–ø–∏—Å–æ–∫ –º–∞—Ç—á–µ–π (–ø—Ä–∏–º–µ—Ä):
- `ID=91 vs "–°–ö–ê –°—Ç–∞–≤—Ä–æ–ø–æ–ª—å" 27.10 11:00 ‚Äî scheduled`
- `ID=92 vs "–ê–∫–∞–¥–µ–º–∏—è" 02.11 10:30 ‚Äî played`
–ö–Ω–æ–ø–∫–∏:
- ¬´–û—Ç–∫—Ä—ã—Ç—å –º–∞—Ç—á #‚Ä¶¬ª
- ¬´‚ûï –°–æ–∑–¥–∞—Ç—å –º–∞—Ç—á¬ª
- ¬´‚¨Ö –ù–∞–∑–∞–¥¬ª

**–≠–∫—Ä–∞–Ω –º–∞—Ç—á–∞:**
- –¥–∞—Ç–∞/–≤—Ä–µ–º—è, –º–µ—Å—Ç–æ, —Å—Ç–∞—Ç—É—Å
- —Å—á—ë—Ç: HT / FT / ET / PEN / –ò—Ç–æ–≥
- —Å–æ—Å—Ç–∞–≤: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ start/sub (–∏ –±—ã—Å—Ç—Ä—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä)
- —Å–æ–±—ã—Ç–∏—è: —Å–ø–∏—Å–æ–∫ —Å —Ç–∞–π–º—à—Ç–∞–º–ø–∞–º–∏
- –∫–Ω–æ–ø–∫–∏:
  - `‚úè –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –º–∞—Ç—á` (–¥–∞—Ç–∞/–≤—Ä–µ–º—è/–º–µ—Å—Ç–æ/—Å—Ç–∞—Ç—É—Å/–≤–≤–æ–¥ —Å—á—ë—Ç–æ–≤)
  - `üë• –°–æ—Å—Ç–∞–≤` (–¥–æ–±–∞–≤–∏—Ç—å –∏–∑ –∑–∞—è–≤–∫–∏, –∏–∑–º–µ–Ω–∏—Ç—å —Ä–æ–ª—å, –∏–∑–º–µ–Ω–∏—Ç—å –Ω–æ–º–µ—Ä –Ω–∞ –º–∞—Ç—á, —É–¥–∞–ª–∏—Ç—å)
  - `‚öΩ –°–æ–±—ã—Ç–∏—è` (–¥–æ–±–∞–≤–∏—Ç—å goal/card/sub, –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–ø–∏—Å–æ–∫)
  - `‚¨Ö –ù–∞–∑–∞–¥`

**–°–æ–∑–¥–∞—Ç—å –º–∞—Ç—á (wizard):**
1) –°–æ–ø–µ—Ä–Ω–∏–∫ ‚Üí 2) –î–∞—Ç–∞ ‚Üí 3) –í—Ä–µ–º—è ‚Üí 4) –õ–æ–∫–∞—Ü–∏—è ‚Üí –°–æ–∑–¥–∞—Ç—å  
(–ü–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —É –ø–∞—Ä—ã `(tournament_id, team_id)` –µ—Å—Ç—å –∑–∞–ø–∏—Å—å(–∏) –≤ `tournament_roster`).

---

## –°—Ö–µ–º–∞ –ë–î (PostgreSQL)

```sql
-- teams
id          BIGSERIAL PRIMARY KEY,
name        TEXT NOT NULL,
short_code  TEXT NOT NULL UNIQUE,
active      BOOLEAN NOT NULL DEFAULT TRUE,
note        TEXT NULL,
created_at  TIMESTAMPTZ NOT NULL DEFAULT NOW(),
updated_at  TIMESTAMPTZ NOT NULL DEFAULT NOW();

-- players
id          BIGSERIAL PRIMARY KEY,
full_name   TEXT NOT NULL,
birth_date  DATE NULL,
position    TEXT NULL,
active      BOOLEAN NOT NULL DEFAULT TRUE,
note        TEXT NULL,
created_at  TIMESTAMPTZ NOT NULL DEFAULT NOW(),
updated_at  TIMESTAMPTZ NOT NULL DEFAULT NOW();

-- tournaments
id          BIGSERIAL PRIMARY KEY,
name        TEXT NOT NULL,
type        TEXT NULL,
status      TEXT NOT NULL DEFAULT 'active',  -- planned/active/finished
start_date  DATE NULL,
end_date    DATE NULL,
note        TEXT NULL,
created_at  TIMESTAMPTZ NOT NULL DEFAULT NOW(),
updated_at  TIMESTAMPTZ NOT NULL DEFAULT NOW();

-- tournament_roster (–∑–∞—è–≤–∫–∞ –Ω–∞ —Ç—É—Ä–Ω–∏—Ä)
id                  BIGSERIAL PRIMARY KEY,
tournament_id       BIGINT NOT NULL REFERENCES tournaments(id),
team_id             BIGINT NOT NULL REFERENCES teams(id),
player_id           BIGINT NOT NULL REFERENCES players(id),
tournament_number   INT NULL,
created_at          TIMESTAMPTZ NOT NULL DEFAULT NOW(),
updated_at          TIMESTAMPTZ NOT NULL DEFAULT NOW(),
UNIQUE (tournament_id, team_id, player_id);

-- matches
id                  BIGSERIAL PRIMARY KEY,
tournament_id       BIGINT NOT NULL REFERENCES tournaments(id),
team_id             BIGINT NOT NULL REFERENCES teams(id),
opponent_name       TEXT NOT NULL,
start_time          TIMESTAMPTZ NOT NULL,
location            TEXT NULL,
status              TEXT NOT NULL DEFAULT 'scheduled',  -- scheduled/played/canceled
score_ht            TEXT NULL,
score_ft            TEXT NULL,
score_et            TEXT NULL,
score_pen           TEXT NULL,
score_final_us      INT NULL,
score_final_them    INT NULL,
created_at          TIMESTAMPTZ NOT NULL DEFAULT NOW(),
updated_at          TIMESTAMPTZ NOT NULL DEFAULT NOW();

-- match_lineups
id                  BIGSERIAL PRIMARY KEY,
match_id            BIGINT NOT NULL REFERENCES matches(id) ON DELETE CASCADE,
player_id           BIGINT NOT NULL REFERENCES players(id),
role                TEXT NOT NULL,     -- 'start' | 'sub'
number_override     INT NULL,
note                TEXT NULL,
created_at          TIMESTAMPTZ NOT NULL DEFAULT NOW(),
updated_at          TIMESTAMPTZ NOT NULL DEFAULT NOW(),
UNIQUE (match_id, player_id);

-- match_events
id                  BIGSERIAL PRIMARY KEY,
match_id            BIGINT NOT NULL REFERENCES matches(id) ON DELETE CASCADE,
event_type          TEXT NOT NULL,     -- 'goal' | 'card' | 'sub'
event_time          TEXT NOT NULL,
player_id_main      BIGINT NULL REFERENCES players(id),
player_id_alt       BIGINT NULL REFERENCES players(id),
card_type           TEXT NULL,         -- 'yellow' | 'red'
created_at          TIMESTAMPTZ NOT NULL DEFAULT NOW();
```

---

## –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞

1. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è: –≤—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –¥–æ—Å—Ç—É–ø–Ω—ã **—Ç–æ–ª—å–∫–æ** –∞–¥–º–∏–Ω–∞–º.
2. –°–æ–∑–¥–∞–Ω–∏–µ –º–∞—Ç—á–∞: —É –ø–∞—Ä—ã `(tournament_id, team_id)` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –∏–≥—Ä–æ–∫ –≤ `tournament_roster`.
3. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ —Å–æ—Å—Ç–∞–≤ –º–∞—Ç—á–∞: `player_id` –æ–±—è–∑–∞–Ω –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –≤ `tournament_roster` —Ç–æ–π –∂–µ –ø–∞—Ä—ã.
4. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è: –≤—Å–µ —Ñ–∏–≥—É—Ä–∏—Ä—É—é—â–∏–µ –∏–≥—Ä–æ–∫–∏ –¥–æ–ª–∂–Ω—ã –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –≤ `tournament_roster` –ø–∞—Ä—ã –º–∞—Ç—á–∞.
5. `status = canceled` —É –º–∞—Ç—á–∞ ‚Üí –≤—Å–µ –ø–æ–ª—è —Å—á—ë—Ç–∞ –æ—á–∏—â–∞—é—Ç—Å—è –¥–æ `NULL`.
6. –§–æ—Ä–º–∞—Ç—ã —Å—á—ë—Ç–æ–≤:
   - `score_ht/ft/et/pen` ‚Äî —Å—Ç—Ä–æ–∫–∞ ¬´X:Y¬ª (–±–µ–∑ –ø–∞—Ä—Å–∏–Ω–≥–∞ –≤ INT).
   - `score_final_us/score_final_them` ‚Äî INT.
7. `MatchLineupItem` ‚Äî `UNIQUE (match_id, player_id)`: –ø–æ–≤—Ç–æ—Ä ‚Äî —ç—Ç–æ **update**, –∞ –Ω–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ.

---

## –ù–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- –ë–æ—Ç –Ω–µ –ø–∞–¥–∞–µ—Ç –Ω–∞ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –∞–ø–¥–µ–π—Ç–∞—Ö; –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –∏ –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –∞–ø–¥–µ–π—Ç–∞.
- –õ–æ–≥–∏ –≤ stdout: `timestamp, admin_tg_id, action, entity, entity_id, status`.
- –û—Ç–≤–µ—Ç—ã —á–µ–ª–æ–≤–µ–∫—É ‚Äî –∫—Ä–∞—Ç–∫–∏–µ –∏ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ.
- –Ø–∑—ã–∫ –æ—Ç–≤–µ—Ç–æ–≤ –±–æ—Ç–∞ ‚Äî —Ä—É—Å—Å–∫–∏–π.
- –ö–æ–¥ –º–æ–¥—É–ª—å–Ω—ã–π: —Å–µ—Ä–≤–∏—Å—ã –Ω–µ –∑–Ω–∞—é—Ç –æ Telegram; Telegram-—Å–ª–æ–π –≤—ã–∑—ã–≤–∞–µ—Ç —Å–µ—Ä–≤–∏—Å—ã.

---

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –æ–∫—Ä—É–∂–µ–Ω–∏–µ

–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
- `BOT_TOKEN` ‚Äî —Ç–æ–∫–µ–Ω Telegram-–±–æ—Ç–∞
- `DB_DSN` ‚Äî DSN PostgreSQL (–Ω–∞–ø—Ä–∏–º–µ—Ä: `postgres://user:pass@host:5432/db?sslmode=disable`)
- `ADMIN_IDS` ‚Äî —Å–ø–∏—Å–æ–∫ Telegram user_id —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é: `12345,67890`

–†–µ–∂–∏–º—ã –∑–∞–ø—É—Å–∫–∞:
- –ª–æ–∫–∞–ª—å–Ω–æ (dev)
- –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (Docker) ‚Äî –ø–æ –∂–µ–ª–∞–Ω–∏—é

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```
/cmd/bot/main.go
/internal/config/           # –ø–∞—Ä—Å–∏–Ω–≥ env, –∫–æ–Ω—Ñ–∏–≥
/internal/telegram/         # —Ö–µ–Ω–¥–ª–µ—Ä—ã, —Ä–µ–Ω–¥–µ—Ä —ç–∫—Ä–∞–Ω–æ–≤, inline-–∫–Ω–æ–ø–∫–∏, callback_data
/internal/session/          # admin_sessions (state machine, —Å—Ç–µ–∫ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏)
/internal/models/           # –¥–æ–º–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏
/internal/repository/       # SQL –¥–æ—Å—Ç—É–ø (CRUD)
/internal/service/          # –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (Teams/Players/Tournaments/Rosters/Matches/Lineup/Events)
/migrations/                # SQL –º–∏–≥—Ä–∞—Ü–∏–∏
/docs/                      # –¥–æ–ø. –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è, –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
```

**admin_sessions (—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è):**
- `admin_tg_id BIGINT`
- `current_flow TEXT`
- `flow_state JSONB`
- `updated_at TIMESTAMPTZ`

---

## –ú–∏–≥—Ä–∞—Ü–∏–∏

- –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç: `goose` (–∏–ª–∏ –∞–Ω–∞–ª–æ–≥), —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–æ–≤: `0001_init.sql`, `0002_...sql` –∏ —Ç.–¥.
- –ú–∏–≥—Ä–∞—Ü–∏–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã –∏ –¥–æ–ª–∂–Ω—ã –ø—Ä–∏–º–µ–Ω—è—Ç—å—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è/—á–µ—Ä–µ–∑ Makefile.

---

## Definition of Done

–≠—Ç–∞–ø —Å—á–∏—Ç–∞–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–º, –µ—Å–ª–∏ –∞–¥–º–∏–Ω –º–æ–∂–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É—è **—Ç–æ–ª—å–∫–æ –∫–Ω–æ–ø–∫–∏**:

- –°–æ–∑–¥–∞–≤–∞—Ç—å –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å **—Ç—É—Ä–Ω–∏—Ä—ã**.
- –°–æ–∑–¥–∞–≤–∞—Ç—å –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å **–∫–æ–º–∞–Ω–¥—ã**.
- –°–æ–∑–¥–∞–≤–∞—Ç—å –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å **–∏–≥—Ä–æ–∫–æ–≤**.
- –ß–µ—Ä–µ–∑ `/tournament_rosters`: —É–ø—Ä–∞–≤–ª—è—Ç—å –∑–∞—è–≤–∫–∞–º–∏ (–¥–æ–±–∞–≤–ª—è—Ç—å/—É–¥–∞–ª—è—Ç—å –∏–≥—Ä–æ–∫–∞, –º–µ–Ω—è—Ç—å –Ω–æ–º–µ—Ä).
- –ß–µ—Ä–µ–∑ `/games`: –ø–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É —Ç—É—Ä–Ω–∏—Ä—É –∏ –∫–æ–º–∞–Ω–¥–µ
  - —Å–æ–∑–¥–∞–≤–∞—Ç—å –º–∞—Ç—á–∏,
  - —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞—Ç—É/–≤—Ä–µ–º—è/–º–µ—Å—Ç–æ/—Å—Ç–∞—Ç—É—Å/—Å—á—ë—Ç—ã (HT/FT/ET/PEN/–∏—Ç–æ–≥),
  - —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ—Å—Ç–∞–≤–æ–º (–¥–æ–±–∞–≤–ª—è—Ç—å –∏–∑ –∑–∞—è–≤–∫–∏, –º–µ–Ω—è—Ç—å —Ä–æ–ª—å, –Ω–æ–º–µ—Ä –Ω–∞ –º–∞—Ç—á, —É–¥–∞–ª—è—Ç—å),
  - –¥–æ–±–∞–≤–ª—è—Ç—å —Å–æ–±—ã—Ç–∏—è –º–∞—Ç—á–∞ —Ç–∏–ø–æ–≤ `goal`, `card (yellow/red)`, `sub`,
  - –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π.
- –ù–µ-–∞–¥–º–∏–Ω –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –ø—Ä–∞–≤.
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ stdout —Ä–∞–±–æ—Ç–∞–µ—Ç.

---

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è Codex

### Callback-–ø–∞—Ç—Ç–µ—Ä–Ω—ã

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ `callback_data` –≤–∏–¥–∞:  
  `action|k1=v1|k2=v2`  
  –ü—Ä–∏–º–µ—Ä—ã:  
  - `open_tournament|id=7`  
  - `open_roster|t=7|team=12`  
  - `add_roster_player|t=7|team=12|page=2`  
  - `open_match|id=91`  
  - `lineup_add|match=91`

- –ù—É–∂–µ–Ω —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–µ—Ä `callback_data` ‚Üí `struct { Action string; Args map[string]string }`.

### State machine / wizard

- –¢–∞–±–ª–∏—Ü–∞ `admin_sessions` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è.
- –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ —Ö–µ–ª–ø–µ—Ä—ã:
  - `StartFlow(adminID, flowName, initialState)`
  - `AdvanceFlow(adminID, userText)`
  - `CancelFlow(adminID)`
- –ù–∞–≤–∏–≥–∞—Ü–∏—è ¬´‚¨Ö –ù–∞–∑–∞–¥¬ª —á–µ—Ä–µ–∑ —Å—Ç–µ–∫ —ç–∫—Ä–∞–Ω–æ–≤ –≤ `flow_state`:
  - –ø—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã: `{"screens":[{...}, {...}]}`

### –°–µ—Ä–≤–∏—Å—ã (–∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã)

```go
type TeamsService interface {
    ListActive() ([]Team, error)
    Get(id int64) (*Team, error)
    Create(name, shortCode string, active bool, note *string) (int64, error)
    Update(id int64, patch TeamPatch) error
}

type PlayersService interface {
    List(p Page) ([]Player, error)
    Get(id int64) (*Player, error)
    Create(fullName string, birth *time.Time, position *string, active bool, note *string) (int64, error)
    Update(id int64, patch PlayerPatch) error
    ListAssignments(playerID int64) ([]PlayerAssignment, error) // —Ç—É—Ä–Ω–∏—Ä/–∫–æ–º–∞–Ω–¥–∞/–Ω–æ–º–µ—Ä
}

type TournamentsService interface {
    List(status *string) ([]Tournament, error)
    Get(id int64) (*Tournament, error)
    Create(name, typ, status string, start, end *time.Time, note *string) (int64, error)
    Update(id int64, patch TournamentPatch) error
}

type RostersService interface {
    ListTeamsInTournament(tournamentID int64) ([]Team, error)
    ListRoster(tournamentID, teamID int64) ([]RosterRow, error)
    AddPlayer(tournamentID, teamID, playerID int64, number *int) error
    UpdateNumber(tournamentID, teamID, playerID int64, number *int) error
    RemovePlayer(tournamentID, teamID, playerID int64) error
    EnsureTeamHasPlayers(tournamentID, teamID int64) (bool, error)
}

type MatchesService interface {
    List(tournamentID, teamID int64) ([]Match, error)
    Get(id int64) (*Match, error)
    Create(tournamentID, teamID int64, opponent string, start time.Time, location *string) (int64, error)
    Update(id int64, patch MatchPatch) error // –¥–∞—Ç–∞/–≤—Ä–µ–º—è/–º–µ—Å—Ç–æ/—Å—Ç–∞—Ç—É—Å/—Å—á—ë—Ç—ã
}

type LineupService interface {
    Get(matchID int64) (Lineup, error)
    Upsert(matchID, playerID int64, role string, numberOverride *int, note *string) error
    Update(matchID, playerID int64, patch LineupPatch) error
    Remove(matchID, playerID int64) error
}

type EventsService interface {
    List(matchID int64) ([]MatchEvent, error)
    AddGoal(matchID, playerID int64, timeText string) error
    AddCard(matchID, playerID int64, cardType, timeText string) error // 'yellow' or 'red'
    AddSub(matchID, playerOutID, playerInID int64, timeText string) error
}
```

**–ü—Ä–∞–≤–∏–ª–∞ –ø—Ä–æ–≤–µ—Ä–æ–∫ –≤ —Å–µ—Ä–≤–∏—Å–∞—Ö:**
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è ‚Äî –¥–æ –≤—Ö–æ–¥–∞ –≤ —Å–µ—Ä–≤–∏—Å (–≤ Telegram-—Å–ª–æ–µ).
- MatchesService.Create ‚Üí `EnsureTeamHasPlayers(...)`
- LineupService.Upsert/Update ‚Üí –∏–≥—Ä–æ–∫ ‚àà `tournament_roster` –¥–ª—è –ø–∞—Ä—ã `(match.tournament_id, match.team_id)`
- EventsService.Add* ‚Üí –≤—Å–µ –∏–≥—Ä–æ–∫–∏ ‚àà `tournament_roster` –¥–ª—è –ø–∞—Ä—ã –º–∞—Ç—á–∞
- Update –º–∞—Ç—á–∞ —Å–æ `status=canceled` ‚Üí –æ—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ —Å—á—ë—Ç—ã

### –ó–∞–¥–∞—á–∏ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ Codex

1. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ SQL –¥–ª—è –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü –≤ `/migrations`.  
2. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–æ–º–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ (`/internal/models`).  
3. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ (CRUD) –¥–ª—è –≤—Å–µ—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π.  
4. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å—ã –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã —Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø—Ä–æ–≤–µ—Ä–æ–∫.  
5. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å Telegram-—Å–ª–æ–π:
   - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ `/tournaments`, `/teams`, `/players`, `/tournament_rosters`, `/games`
   - —Ä–µ–Ω–¥–µ—Ä —Å–ø–∏—Å–∫–æ–≤ –∏ –∫–∞—Ä—Ç–æ—á–µ–∫
   - —Å–æ–∑–¥–∞–Ω–∏–µ inline-–∫–Ω–æ–ø–æ–∫ –∏ –ø–∞—Ä—Å–µ—Ä `callback_data`
   - state machine (wizard + —Å—Ç–µ–∫ —ç–∫—Ä–∞–Ω–æ–≤ ¬´‚¨Ö –ù–∞–∑–∞–¥¬ª)
6. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `.env` –ø–∞—Ä—Å–µ—Ä –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—é –Ω–∞—Å—Ç—Ä–æ–µ–∫ (`BOT_TOKEN`, `DB_DSN`, `ADMIN_IDS`).  
7. –ù–∞–ø–∏—Å–∞—Ç—å `Makefile`/—Å–∫—Ä–∏–ø—Ç—ã –∑–∞–ø—É—Å–∫–∞ (–ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π, –∑–∞–ø—É—Å–∫ –±–æ—Ç–∞).

---

## –î–∞–ª—å–Ω–µ–π—à–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (–Ω–µ –≤ —ç—Ç–æ–º —ç—Ç–∞–ø–µ)

- –¢–∞–±–ª–∏—Ü–∞ —Ç—É—Ä–Ω–∏—Ä–∞ (–æ—á–∫–∏/—Ä–∞–∑–Ω–∏—Ü–∞/–º–µ—Å—Ç–æ) –∏ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –º–∞—Ç—á–µ–π.
- –ü—É–±–ª–∏—á–Ω—ã–µ –≤–∏—Ç—Ä–∏–Ω—ã (–ø—Ä–æ—Å–º–æ—Ç—Ä —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è/—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤/—Ç–∞–±–ª–∏—Ü).
- –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä–æ–∫–∞ –ø–æ —Ç—É—Ä–Ω–∏—Ä–∞–º (–≥–æ–ª—ã/–∫–∞—Ä—Ç–æ—á–∫–∏/–º–∏–Ω—É—Ç—ã).
- –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –ø–æ—Å—Ç—ã, —Å—Ç–æ—Ä–∏–∑, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Å–∞–π—Ç–æ–º.
- –ö–æ–Ω–∫—É—Ä—Å –ø—Ä–æ–≥–Ω–æ–∑–æ–≤.
- –†–æ–ª–∏ ¬´—Ç—Ä–µ–Ω–µ—Ä –∫–æ–º–∞–Ω–¥—ã¬ª, ¬´—Ä–µ–¥–∞–∫—Ç–æ—Ä¬ª —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏ –ø–æ –≤–∏–¥–∏–º–æ—Å—Ç–∏ –∏ –ø—Ä–∞–≤–∞–º.
- –≠–∫—Å–ø–æ—Ä—Ç CSV/Excel, –æ—Ç—á—ë—Ç—ã, –ø–µ—á–∞—Ç–Ω—ã–µ —Ñ–æ—Ä–º—ã —Å–æ—Å—Ç–∞–≤–æ–≤/–ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤.

---

**–ö–æ–Ω–µ—Ü –¥–æ–∫—É–º–µ–Ω—Ç–∞.**
